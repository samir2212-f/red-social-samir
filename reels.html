<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Subir Reels</title>
  <style>
    body { 
      display:flex; flex-direction:column; 
      align-items:center; justify-content:center; 
      height:100vh; background:black; color:white; 
      font-family:sans-serif;
    }
    button {
      margin-top:10px; padding:10px 20px; 
      background:linear-gradient(45deg,#ff0057,#ff7b00);
      border:none; border-radius:20px; color:white; 
      font-size:16px; cursor:pointer;
    }
    input { margin-top:15px; }
  </style>
</head>
<body>
  <h2>üì§ Subir Reel</h2>
  <input type="file" id="videoFile" accept="video/*">
  <button onclick="uploadReel()">Publicar</button>

  <!-- SDK de Supabase -->
  <script src="https://unpkg.com/@supabase/supabase-js"></script>
  <script>
    // ‚ö° Configuraci√≥n Supabase
    const SUPABASE_URL = "https://klziukovalzzcinifvaw.supabase.co";
    const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imtseml1a292YWx6emNpbmlmdmF3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY0Mzg1MDcsImV4cCI6MjA3MjAxNDUwN30.edpw-UnymgHSAhp54SX6CCKfEjB7SQDdSrhH3wc-Eh4";
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    async function uploadReel() {
      const fileInput = document.getElementById("videoFile");
      if (fileInput.files.length === 0) {
        alert("Selecciona un video primero");
        return;
      }

      const file = fileInput.files[0];
      const fileName = "reels/" + Date.now() + "-" + file.name; // üëà carpeta reels

      // üëá Subir al bucket Samir
      const { data, error } = await supabase.storage
        .from("Samir")
        .upload(fileName, file, { cacheControl: "3600", upsert: false });

      if (error) {
        console.error(error);
        alert("‚ùå Error al subir el video: " + error.message);
        return;
      }

      // üëá Generar URL p√∫blica
      const { data: publicUrl } = supabase
        .storage
        .from("Samir")
        .getPublicUrl(fileName);

      console.log("‚úÖ URL p√∫blica:", publicUrl.publicUrl);

      alert("‚úÖ Video subido correctamente");
      window.location.href = "feed.html"; // üëà te manda al feed
    }
  </script>
</body>
</html>
