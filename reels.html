<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Subir Reels</title>
  <style>
    body { background:black; color:white; text-align:center; font-family:sans-serif; }
    .btn {
      background: linear-gradient(to right, #ff0050, #00f2ea);
      color:white; padding:10px 20px; border:none; border-radius:20px;
      margin:10px; cursor:pointer; font-size:16px;
    }
    video { width:300px; border-radius:12px; margin:20px auto; display:block; }
  </style>
</head>
<body>
  <h2>üìπ Subir Reels</h2>
  <input type="file" id="videoInput" accept="video/*" style="display:none">
  <button class="btn" onclick="document.getElementById('videoInput').click()">üé¨ Seleccionar Video</button>
  <br>
  <video id="preview" controls></video>
  <br>
  <button class="btn" onclick="uploadVideo()">‚¨ÜÔ∏è Publicar</button>

  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script>
    let selectedFile;
    const videoInput = document.getElementById('videoInput');
    const preview = document.getElementById('preview');

    videoInput.addEventListener('change', e => {
      selectedFile = e.target.files[0];
      preview.src = URL.createObjectURL(selectedFile);
    });

    async function uploadVideo() {
      if(!selectedFile) return alert("Selecciona un video primero");

      let formData = new FormData();
      formData.append("file", selectedFile);
      formData.append("upload_preset", "ml_default"); // tu preset de Cloudinary

      try {
        let res = await axios.post("https://api.cloudinary.com/v1_1/dbgpvwprb/video/upload", formData);
        let videoUrl = res.data.secure_url;

        // Guardar en localStorage
        let reels = JSON.parse(localStorage.getItem("reels")) || [];
        reels.push(videoUrl);
        localStorage.setItem("reels", JSON.stringify(reels));

        // ‚úÖ Enviar directo a feed
        window.location.href = "feed.html";

      } catch(err) {
        console.error(err);
        alert("Error subiendo el video");
      }
    }
  </script>
</body>
</html>
