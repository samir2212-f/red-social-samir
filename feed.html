<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Reels</title>
  <style>
    body { margin:0; background:black; overflow:hidden; }
    .reel {
      position:relative; height:100vh; width:100%;
      display:flex; justify-content:center; align-items:center;
    }
    video { height:100vh; width:100%; object-fit:cover; }
    .actions {
      position:absolute; right:15px; bottom:100px;
      display:flex; flex-direction:column; gap:20px; font-size:22px; color:white;
    }
    .actions button {
      background:rgba(0,0,0,0.5); border:none; border-radius:50%;
      width:50px; height:50px; color:white; font-size:22px; cursor:pointer;
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
  <div id="feed"></div>

  <script>
    // Configuraci√≥n de tu Supabase
    const supabaseUrl = "https://klziukovalzzcinifvaw.supabase.co";
    const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imtseml1a292YWx6emNpbmlmdmF3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY0Mzg1MDcsImV4cCI6MjA3MjAxNDUwN30.edpw-UnymgHSAhp54SX6CCKfEjB7SQDdSrhH3wc-Eh4";
    const supabaseClient = supabase.createClient(supabaseUrl, supabaseKey);

    const bucketName = "videos";

    async function loadFeed() {
      const { data, error } = await supabaseClient.storage.from(bucketName).list("", {
        limit: 50,
        offset: 0
      });

      if (error) {
        console.error("Error al cargar feed:", error);
        return;
      }

      const feed = document.getElementById("feed");
      feed.innerHTML = "";

      for (let file of data.reverse()) { // üëà mostrar los √∫ltimos primero
        const { data: urlData } = await supabaseClient
          .storage
          .from(bucketName)
          .getPublicUrl(file.name);

        let reel = document.createElement("div");
        reel.className = "reel";

        reel.innerHTML = `
          <video src="${urlData.publicUrl}" controls loop></video>
          <div class="actions">
            <button>‚ù§Ô∏è</button>
            <button>üí¨</button>
            <button>üîó</button>
          </div>
        `;
        feed.appendChild(reel);
      }

      // Scroll tipo TikTok
      let current = 0;
      window.addEventListener("wheel", e => {
        if(e.deltaY > 0 && current < feed.children.length-1) current++;
        else if(e.deltaY < 0 && current > 0) current--;
        feed.style.transform = `translateY(-${current*100}vh)`;
        feed.style.transition = "0.6s";
      });
    }

    loadFeed();
  </script>
</body>
</html>
