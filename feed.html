<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Reels</title>
  <style>
    body { margin:0; background:black; overflow:hidden; }
    .reel {
      position:relative; height:100vh; width:100%;
      display:flex; justify-content:center; align-items:center;
    }
    video { height:100vh; width:100%; object-fit:cover; }
    .actions {
      position:absolute; right:15px; bottom:100px;
      display:flex; flex-direction:column; gap:20px; font-size:22px; color:white;
    }
    .actions button {
      background:rgba(0,0,0,0.5); border:none; border-radius:50%;
      width:50px; height:50px; color:white; font-size:22px; cursor:pointer;
    }
  </style>
</head>
<body>
  <div id="feed"></div>

  <!-- SDK de Supabase -->
  <script src="https://unpkg.com/@supabase/supabase-js"></script>
  <script>
    // ‚ö° Configuraci√≥n Supabase
    const SUPABASE_URL = "https://klziukovalzzcinifvaw.supabase.co";
    const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imtseml1a292YWx6emNpbmlmdmF3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY0Mzg1MDcsImV4cCI6MjA3MjAxNDUwN30.edpw-UnymgHSAhp54SX6CCKfEjB7SQDdSrhH3wc-Eh4";
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    const feed = document.getElementById("feed");

    // ‚ö° Traer todos los videos del bucket Samir
    async function loadReels() {
      const { data, error } = await supabase.storage.from("Samir").list("", {
        limit: 100,
        sortBy: { column: "created_at", order: "desc" }
      });

      if (error) {
        console.error("Error cargando videos:", error.message);
        return;
      }

      for (let file of data) {
        const { data: publicUrl } = supabase
          .storage
          .from("Samir")
          .getPublicUrl(file.name);

        let reel = document.createElement("div");
        reel.className = "reel";

        reel.innerHTML = `
          <video src="${publicUrl.publicUrl}" controls loop></video>
          <div class="actions">
            <button>‚ù§Ô∏è</button>
            <button>üí¨</button>
            <button>üîó</button>
          </div>
        `;
        feed.appendChild(reel);
      }
    }

    loadReels();

    // Scroll tipo TikTok
    let current = 0;
    window.addEventListener("wheel", e => {
      const reels = document.querySelectorAll(".reel");
      if(e.deltaY > 0 && current < reels.length-1) current++;
      else if(e.deltaY < 0 && current > 0) current--;
      feed.style.transform = `translateY(-${current*100}vh)`;
      feed.style.transition = "0.6s";
    });
  </script>
</body>
</html>
